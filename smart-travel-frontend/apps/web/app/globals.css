@tailwind base;
@tailwind components;
@tailwind utilities;

/* ---------- Theme tokens (RGB) ---------- */
:root {
  --bg: 248 250 255;
  --surface: 255 255 255;
  --surface-muted: 237 241 255;
  --text: 24 28 44;
  --muted: 120 130 160;
  --border: 208 216 238;
  --accent: 92 126 255;
  --accent-contrast: 255 255 255;
  --ring: 92 126 255;
  --shadow-color: 18 26 64;
  --bg-gradient:
    radial-gradient(1200px 820px at -10% -8%, rgba(148, 175, 255, .35), transparent 65%),
    radial-gradient(1000px 720px at 110% 10%, rgba(255, 205, 170, .32), transparent 70%),
    linear-gradient(185deg, #f4f7ff 0%, #eef2fb 48%, #eaeef9 100%);
  --shadow: 0 28px 50px rgba(var(--shadow-color) / .18);
}

.dark {
  --bg: 7 8 18;
  --surface: 22 26 44;
  --surface-muted: 14 17 32;
  --text: 233 238 255;
  --muted: 150 158 198;
  --border: 52 58 90;
  --accent: 120 90 255;
  --accent-contrast: 255 255 255;
  --ring: 140 115 255;
  --shadow-color: 4 8 20;
  --bg-gradient:
    radial-gradient(1600px 1000px at -15% -12%, rgba(82, 116, 255, .32), transparent 60%),
    radial-gradient(1400px 900px at 120% 6%, rgba(30, 200, 255, .18), transparent 68%),
    linear-gradient(210deg, #050713 0%, #080b1d 45%, #04050c 100%);
  --shadow: 0 32px 80px rgba(var(--shadow-color) / .58);
}

/* ---------- Base ---------- */
@layer base {
  html,
  body {
    @apply h-full;
  }

  body {
    background: var(--bg-gradient), rgb(var(--bg));
    color: rgb(var(--text));
    transition: background .45s ease, color .35s ease;
    font-weight: 520;
    -webkit-font-smoothing: antialiased;
  }

  h1,
  h2,
  h3 {
    color: rgb(var(--text));
    font-weight: 780;
    letter-spacing: -0.03em;
  }

  h4,
  h5,
  h6 {
    color: rgb(var(--text));
    font-weight: 660;
    letter-spacing: -0.02em;
  }

  p,
  span,
  li,
  small {
    color: color-mix(in oklab, rgb(var(--text)) 88%, rgb(var(--muted)) 12%);
    font-weight: 520;
  }

  ::selection {
    @apply bg-indigo-500 text-white;
  }

  a {
    @apply underline-offset-4 decoration-transparent transition hover:decoration-current;
  }
}

/* ---------- Components ---------- */
@layer components {
  /* Panels / cards */
  .card {
    @apply rounded-2xl border p-4 md:p-5;
    background: linear-gradient(160deg, rgba(var(--surface) / .96), rgba(var(--surface-muted) / .75));
    border-color: rgb(var(--border) / .65);
    box-shadow: var(--shadow);
    backdrop-filter: saturate(130%) blur(14px);
    color: rgb(var(--text));
  }

  /* Single, richer .glass (kept) */
  .glass {
    @apply rounded-2xl border;
    background:
      linear-gradient(180deg, rgba(var(--surface) / .88), rgba(var(--surface-muted) / .55)),
      color-mix(in oklab, rgb(var(--surface)) 52%, transparent);
    border-color: rgb(var(--border) / .6);
    box-shadow: var(--shadow);
    backdrop-filter: saturate(150%) blur(18px);
    color: rgb(var(--text));
  }

  /* Buttons */
  .btn {
    @apply inline-flex items-center justify-center gap-2 rounded-xl border px-3 py-2 text-sm font-medium transition;
    border-color: rgb(var(--border) / .55);
    background: color-mix(in oklab, rgb(var(--surface)) 78%, transparent);
    color: rgb(var(--text));
  }

  .btn:hover {
    @apply -translate-y-px;
    filter: brightness(1.06);
  }

  .btn:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px rgb(var(--ring) / .35);
  }

  .btn-primary {
    background: rgb(var(--accent));
    color: rgb(var(--accent-contrast));
    border-color: rgb(var(--accent) / .75);
  }

  .btn-primary:hover {
    filter: brightness(1.08);
  }

  .btn-ghost {
    background: transparent;
    border-color: rgb(var(--border) / .5);
  }

  /* Sidebar */
  .sidebar {
    @apply h-full rounded-2xl border p-4 md:p-5;
    background:
      linear-gradient(200deg, rgba(var(--surface) / .92), rgba(var(--surface-muted) / .7)),
      radial-gradient(900px 520px at -10% 0%, rgb(var(--accent) / .18), transparent 72%);
    border-color: rgb(var(--border) / .75);
    backdrop-filter: blur(20px) saturate(160%);
    color: rgb(var(--text));
  }

  .nav-item {
    @apply flex items-center justify-between gap-3 rounded-xl border px-3 py-2 text-sm;
    border-color: rgb(var(--border) / .6);
    background: color-mix(in oklab, rgb(var(--surface)) 88%, transparent);
  }

  .nav-item:hover {
    @apply translate-x-[2px];
  }

  .nav-item-active {
    @apply border-transparent;
    background:
      linear-gradient(120deg, rgba(var(--accent) / .22), rgba(var(--surface) / .85));
    color: rgb(var(--text));
  }

  .badge-pro {
    @apply rounded-full border px-3 py-1 text-[10px] uppercase tracking-[0.25em] transition;
    border-color: rgb(var(--border) / .6);
    background: rgba(var(--accent) / .18);
    color: rgb(var(--text));
  }

  /* ---------- Liquid / Glassy "Apple-style" helpers ---------- */
  .ui-glass {
    @apply rounded-2xl border;
    background:
      linear-gradient(180deg, rgb(var(--surface) / .68), rgb(var(--surface-muted) / .28)),
      color-mix(in oklab, rgb(var(--surface)) 46%, transparent);
    border-color: rgb(var(--border) / .55);
    box-shadow:
      0 40px 90px rgba(var(--shadow-color) / .4),
      inset 0 1px 0 rgba(255, 255, 255, .12);
    backdrop-filter: blur(26px) saturate(165%);
  }

  .ui-shine {
    position: relative;
    overflow: hidden;
  }

  .ui-shine::before {
    content: '';
    position: absolute;
    inset: 0;
    background:
      linear-gradient(
        to bottom,
        rgba(255, 255, 255, .35) 0%,
        rgba(255, 255, 255, .18) 40%,
        rgba(255, 255, 255, 0) 60%
      );
    mix-blend-mode: screen;
    pointer-events: none;
  }

  .ui-liquid-icon {
    @apply inline-flex items-center justify-center;
    width: 44px;
    height: 44px;
    border-radius: 14px;
    border: 1px solid rgb(var(--border) / .45);
    background:
      radial-gradient(120% 120% at 10% 0%, rgba(255, 255, 255, .38), rgba(255, 255, 255, .08) 65%, transparent 75%),
      color-mix(in oklab, rgb(var(--surface)) 65%, transparent);
    backdrop-filter: blur(18px) saturate(150%);
    box-shadow:
      inset 0 1px 0 rgba(255, 255, 255, .18),
      0 18px 40px rgba(8, 12, 30, .3);
    transition: transform .2s ease, filter .2s ease;
  }

  .ui-liquid-icon:hover {
    transform: translateY(-1px);
    filter: brightness(1.06);
  }

  .ui-liquid-icon:active {
    transform: translateY(0);
    filter: brightness(.98);
  }

  .timeline-column {
    @apply rounded-2xl border p-4 transition-colors;
    background:
      linear-gradient(180deg, rgba(var(--surface) / .88), rgba(var(--surface-muted) / .48));
    border-color: rgb(var(--border) / .55);
    box-shadow: var(--shadow);
  }

  .timeline-dropzone {
    @apply rounded-xl border border-dashed p-4 text-center text-sm transition;
    border-color: rgb(var(--border) / .6);
    color: color-mix(in oklab, rgb(var(--text)) 70%, rgb(var(--muted)) 30%);
    background: rgba(var(--surface-muted) / .18);
  }

  .timeline-item {
    @apply flex flex-col gap-3 rounded-xl border p-4 transition;
    border-color: rgb(var(--border) / .55);
    background:
      linear-gradient(160deg, rgba(var(--surface) / .9), rgba(var(--surface-muted) / .5));
    box-shadow: 0 16px 32px rgba(var(--shadow-color) / .22);
  }

  .timeline-item:hover {
    transform: translateY(-1px);
    filter: brightness(1.02);
  }

  .timeline-select,
  .timeline-input {
    @apply rounded-md border px-2 py-1 text-xs transition;
    border-color: rgb(var(--border) / .6);
    background: rgba(var(--surface) / .72);
    color: rgb(var(--text));
  }

  .timeline-select:focus,
  .timeline-input:focus {
    outline: none;
    box-shadow: 0 0 0 2px rgba(var(--ring) / .3);
  }
}

/* ---------- Content shells ---------- */
.content-shell {
  @apply rounded-[32px] border p-6 md:p-8 transition;
  background:
    linear-gradient(200deg, rgba(var(--surface) / .88), rgba(var(--surface-muted) / .42));
  border-color: rgb(var(--border) / .55);
  box-shadow:
    0 40px 80px rgba(var(--shadow-color) / .18),
    inset 0 1px 0 rgba(255, 255, 255, .08);
  backdrop-filter: blur(24px) saturate(150%);
  color: rgb(var(--text));
}

.content-header {
  @apply rounded-[28px] border p-6 md:p-8 transition;
  background:
    linear-gradient(180deg, rgba(var(--surface) / .92), rgba(var(--surface-muted) / .48));
  border-color: rgb(var(--border) / .5);
  box-shadow: 0 32px 70px rgba(var(--shadow-color) / .15);
}

.content-card {
  @apply rounded-[28px] border p-6 transition;
  background:
    linear-gradient(195deg, rgba(var(--surface) / .9), rgba(var(--surface-muted) / .38));
  border-color: rgb(var(--border) / .52);
  box-shadow: 0 26px 60px rgba(var(--shadow-color) / .14);
  backdrop-filter: blur(20px) saturate(140%);
  color: rgb(var(--text));
}

.content-subtle {
  @apply rounded-[24px] border p-5 transition;
  background: rgba(var(--surface-muted) / .35);
  border-color: rgb(var(--border) / .4);
}

.form-label {
  @apply text-xs uppercase tracking-[0.32em];
  color: color-mix(in oklab, rgb(var(--text)) 65%, rgb(var(--muted)) 35%);
}

.form-helper {
  @apply text-xs;
  color: color-mix(in oklab, rgb(var(--text)) 60%, rgb(var(--muted)) 40%);
}

.input-surface,
.textarea-surface {
  @apply rounded-2xl border px-3 py-2 text-sm transition disabled:cursor-not-allowed disabled:opacity-60;
  border-color: rgb(var(--border) / .55);
  background: rgba(var(--surface) / .75);
  color: rgb(var(--text));
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, .08);
}

.input-surface::placeholder,
.textarea-surface::placeholder {
  color: color-mix(in oklab, rgb(var(--text)) 55%, rgb(var(--muted)) 45%);
}

.input-surface:focus-visible,
.textarea-surface:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px rgba(var(--ring) / .32);
}

/* ---------- Utilities ---------- */
.line-clamp-1 {
  display: -webkit-box;
  -webkit-line-clamp: 1;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Leaflet base CSS */
.leaflet-container {
  @apply rounded-2xl;
}
